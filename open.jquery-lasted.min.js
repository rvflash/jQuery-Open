(function(f){var a={type:{self:"self",blank:"blank",iframe:"iframe"},onview:null,addUniqueIdentifierClass:"unique"};var e={type:a.type.self,container:"body",iframe:{name:"_openbrowser",options:{src:"",scrolling:"auto",frameborder:0},loading:{name:"_openloader",content:"Please be patient, loading ...",enable:true},displayInline:false,domMaxSize:5},popup:{scrollbars:"yes",toolbar:"yes",location:"yes",directories:"yes",menubar:"yes",resizable:"yes",status:"yes",top:0,left:0,height:780,width:420},onExit:null,autoload:false};var g=function(l,k){if(null==f(l).data("_openid")){f(l).data("_openid","_open"+Math.floor((Math.random()*1001)+1))}k.name=f(l).data("_openid");if(f(l).hasClass(a.type.self)){type=a.type.self}else{if(f(l).hasClass(a.type.blank)){type=a.type.blank}else{if(f(l).hasClass(a.type.iframe)){type=a.type.iframe}else{type=k.type}}}if(null!=(url=d(l,k))){switch(type){case a.type.iframe:return i(url,k);case a.type.blank:return c(url,k);case a.type.self:default:return h(url,k)}}};var i=function(l,n){a.onview=n.name;if(0==f("#"+n.iframe.name).length){f(document.body).append('<div id="'+n.iframe.name+'"></div>')}if(n.iframe.loading.enable){if(0==f("#"+n.iframe.loading.name).length){f(document.body).append('<div id="'+n.iframe.loading.name+'">'+n.iframe.loading.content+"</div>")}else{f("#"+n.iframe.loading.name).show()}}if(0==f("#"+n.name).length){var m=[];var k=f.extend({},n.iframe.options,{id:n.name});for(opts in k){m.push(opts+' = "'+k[opts]+'"')}var o=f("#"+n.iframe.name+" iframe");if(n.iframe.domMaxSize<=o.length){o.filter(":first").remove()}f("#"+n.iframe.name).append("<iframe "+m.join(" ")+"></iframe>")}f("#"+n.iframe.name+" iframe").hide();if(n.iframe.loading.enable){if(""==f("#"+n.name).attr("src")){return f("#"+n.name).attr("src",l).load(function(){j(n)})}}return j(n)};var j=function(k){if(a.onview!=k.name){return}if(k.iframe.loading.enable){f("#"+k.iframe.loading.name).hide()}if(k.iframe.displayInline){f("#"+k.name).show()}else{f("#"+k.name).css("display","block")}if(f.isFunction(k.onExit)){k.onExit(k.name)}};var c=function(l,m){var k=m.popup;k.width=(screen.width*0.8);if(k.width<780){m.popup.width=780}k.height=(screen.height*0.8);if(k.height<420){m.popup.height=420}var n=[];for(opts in k){n.push(opts+"="+k[opts])}if(f.isFunction(m.onExit)){m.onExit(m.name)}return window.open(l,k.name,n.join(","))};var h=function(k,l){if(f.isFunction(l.onExit)){l.onExit(l.name)}return window.location.href=k};var d=function(l,k){if(undefined!=f(l).attr("href")){url=f(l).attr("href")}else{if(null!=f(l).data("url")){url=f(l).data("url")}else{if(null!=f(l).data("erl")){url=b(f(l).data("erl"))}else{return null}}}if(f(l).hasClass(a.addUniqueIdentifierClass)){url+=(-1!=url.indexOf("?")?"&":"?")+"_i="+new Date().getTime()}return url};var b=function(p){var m=new String();var l,k,q,o=new String();l="a";k="A";q="z";o="Z";var n=-1,r;while(n++<p.length-1){r=p.charCodeAt(n);if(r>=l.charCodeAt()&&r<=q.charCodeAt()){r=((r-l.charCodeAt()+13)%26)+l.charCodeAt()}else{if(r>=k.charCodeAt()&&r<=o.charCodeAt()){r=((r-k.charCodeAt()+13)%26)+k.charCodeAt()}}m+=String.fromCharCode(r)}return m};f.open=function(l,k){var k=f.extend(e,k);f(k.container).delegate(l,"click",function(m){m.preventDefault();g(this,k)})};f.fn.open=function(k){var k=f.extend(e,k);if(k.autoload){g(f(this).filter(":first"),k)}f(this).bind("click",function(l){l.preventDefault();g(this,k)})}})(jQuery);